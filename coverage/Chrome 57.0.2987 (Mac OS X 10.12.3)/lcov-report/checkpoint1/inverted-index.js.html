<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for checkpoint1/inverted-index.js</title>
    <meta charset="utf-8" />
    <link rel="stylesheet" href="../prettify.css" />
    <link rel="stylesheet" href="../base.css" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style type='text/css'>
        .coverage-summary .sorter {
            background-image: url(../sort-arrow-sprite.png);
        }
    </style>
</head>
<body>
<div class='wrapper'>
  <div class='pad1'>
    <h1>
      <a href="../index.html">all files</a> / <a href="index.html">checkpoint1/</a> inverted-index.js
    </h1>
    <div class='clearfix'>
      <div class='fl pad1y space-right2'>
        <span class="strong">36.96% </span>
        <span class="quiet">Statements</span>
        <span class='fraction'>17/46</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">13.04% </span>
        <span class="quiet">Branches</span>
        <span class='fraction'>3/23</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">42.86% </span>
        <span class="quiet">Functions</span>
        <span class='fraction'>3/7</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">39.53% </span>
        <span class="quiet">Lines</span>
        <span class='fraction'>17/43</span>
      </div>
    </div>
  </div>
  <div class='status-line low'></div>
<pre><table class="coverage">
<tr><td class="line-count quiet">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136</td><td class="line-coverage quiet"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-yes">9×</span>
<span class="cline-any cline-yes">8×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">/**
 * The Inverted Index class
 */
class InvertedIndex {
&nbsp;
  /**
   * Constructor initializes indexes as an empty object
   * and keeps track of the files that have been indexed
   * @constructor
   */
  constructor() {
    this.allIndexed = {};
  }
&nbsp;
  /**
   * Create Index
   * createIndex method takes a single document and builds an index from it
   * @param {Object} file - the file to be indexed
   * @return {Object} the file with words indexed
   */
  createIndex(file, filename) {
    const indexed = {};
    file.forEach((obj, index) =&gt; {
      let text = `${obj.title} ${obj.text}`;
      text = this.tokenize(text);
      text.forEach((word) =&gt; {
        if (!(word in indexed)) {
          indexed[word] = [(index)];
        } else <span class="missing-if-branch" title="else path not taken" >E</span>if (!(indexed[word].includes(index))) {
          indexed[word].push(index);
        }
      });
    });
    this.allIndexed[filename] = indexed;
    return indexed;
  }
&nbsp;
  /**
   * Get Index
   * getIndex method gets the indexed file with words from documents that were
   * found. If the file is not indexed, it calls the create index method
   * @param {Object} file
   * @return {Object} the file with words indexed
   */
  getIndex<span class="fstat-no" title="function not covered" >(file, filename) {</span>
<span class="cstat-no" title="statement not covered" >    if (filename in this.allIndexed) {</span>
<span class="cstat-no" title="statement not covered" >      return this.allIndexed[filename];</span>
    }
<span class="cstat-no" title="statement not covered" >    return this.createIndex(file, filename);</span>
  }
&nbsp;
   /**
   * tokenize method removes special characters and returns an array of words
   * @param {string} text - the text to be tokenized
   * @return {array} array of words in the documents
  */
  tokenize(text) {
    this.text = text;
    let cleanWords = this.text.replace(/[^\w\s]/gi, ' ');
    cleanWords = cleanWords.replace(/\s+/g, ' ').toLowerCase();
    cleanWords = cleanWords.trim();
    return cleanWords.split(' ');
  }
&nbsp;
  /**
   * validateFile method ensures all the documents in a file are valid i.e.
   * they should be arrays of objects that have only title and text keys
   * and Strings as value
   * @param {Object} file - the uploaded and read file
   * @return {Bool} true or false if the method was successful or not
  */
  validateFile<span class="fstat-no" title="function not covered" >(file) {</span>
<span class="cstat-no" title="statement not covered" >    this.file = file;</span>
<span class="cstat-no" title="statement not covered" >    if (Array.isArray(this.file)) {</span>
<span class="cstat-no" title="statement not covered" >      for (let item = 0; item &lt; this.file.length; item += 1) {</span>
<span class="cstat-no" title="statement not covered" >        if ((typeof this.file[item]) !== 'object') {</span>
<span class="cstat-no" title="statement not covered" >          return false;</span>
        }
<span class="cstat-no" title="statement not covered" >        if (Object.keys(this.file[item]).length !== 2 ||</span>
            Object.keys(this.file[item])[0] !== 'title' ||
            Object.keys(this.file[item])[1] !== 'text') {
<span class="cstat-no" title="statement not covered" >          return false;</span>
        }
<span class="cstat-no" title="statement not covered" >        if ((typeof this.file[item].title) !== 'string' ||</span>
            (typeof this.file[item].text) !== 'string') {
<span class="cstat-no" title="statement not covered" >          return false;</span>
        }
      }
<span class="cstat-no" title="statement not covered" >      return true;</span>
    }
<span class="cstat-no" title="statement not covered" >    return false;</span>
  }
&nbsp;
  /**
   * readFile method reads the data from the file being uploaded
   * @param {JSON} fileData - the uploaded file
   * @return {String} string of text in the uploaded file
  */
  readFile<span class="fstat-no" title="function not covered" >(fileData) {</span>
<span class="cstat-no" title="statement not covered" >    this.fileData = fileData;</span>
<span class="cstat-no" title="statement not covered" >    return new Promise((resolve, reject) =&gt; {</span>
<span class="cstat-no" title="statement not covered" >      const reader = new FileReader();</span>
<span class="cstat-no" title="statement not covered" >      reader.onload = e =&gt; <span class="cstat-no" title="statement not covered" >resolve(e.target.result);</span></span>
<span class="cstat-no" title="statement not covered" >      reader.onerror = e =&gt; <span class="cstat-no" title="statement not covered" >reject(`Error reading + ${this.fileData.name}: ${e.target.result}`);</span></span>
<span class="cstat-no" title="statement not covered" >      reader.readAsText(this.fileData);</span>
    });
  }
&nbsp;
  /**
   * readFile method reads the data from the file being uploaded
   * @param {String} word - word that one is searching for
   * @param {Object} file - specific file to search through
   * @return {String} string of text in the uploaded file
  */
  searchIndex<span class="fstat-no" title="function not covered" >(word, filename) {</span>
<span class="cstat-no" title="statement not covered" >    if (filename === 'all') {</span>
<span class="cstat-no" title="statement not covered" >      const filesIndexedDocs = Object.keys(this.allIndexed);</span>
<span class="cstat-no" title="statement not covered" >      return filesIndexedDocs.forEach(doc =&gt; <span class="cstat-no" title="statement not covered" >this.allIndexed[doc][word])</span>;</span>
    }
&nbsp;
<span class="cstat-no" title="statement not covered" >    if (this.allIndexed[filename][word] === undefined) {</span>
<span class="cstat-no" title="statement not covered" >      return false;</span>
    }
<span class="cstat-no" title="statement not covered" >    return this.allIndexed[filename][word];</span>
  }
}
&nbsp;
// readFile: Reads the data from the file being uploaded
// validateFile: Ensures all the documents in a particular file are valid
// tokenize: Strips out special characters from documents to be indexed
// createIndex: Creates the index for documents
// getIndex: Get’s indices created for particular files
// searchIndex: Searches through one or more indices for words
&nbsp;
// module.exports = InvertedIndex;
&nbsp;</pre></td></tr>
</table></pre>
<div class='push'></div><!-- for sticky footer -->
</div><!-- /wrapper -->
<div class='footer quiet pad2 space-top1 center small'>
  Code coverage
  generated by <a href="http://istanbul-js.org/" target="_blank">istanbul</a> at Tue Apr 04 2017 11:34:06 GMT+0100 (WAT)
</div>
</div>
<script src="../prettify.js"></script>
<script>
window.onload = function () {
        if (typeof prettyPrint === 'function') {
            prettyPrint();
        }
};
</script>
<script src="../sorter.js"></script>
</body>
</html>
